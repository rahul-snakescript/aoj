{% extends 'aoj_app/demo/base.html' %}
{% load static %}
{% load i18n aoj_extras %}

{% block page_title %}
  {% get_site_config as config %}

  {% if config.catalogue_seo_title %}
    {{ config.catalogue_seo_title }}
  {% else %}
    The Arms of Jesus - Catalogue
  {% endif %}

{% endblock page_title %}

{% block body_temp %}

  {% get_site_config as config %}
  <section class="catalog_banner" {% if config.catalogue_banner_image %}style="background-image:url({{ config.catalogue_banner_image.url }});"{% endif %}>

    {% get_desktop_nav %}
    <div class="container children_arm">
      <div class="row">
        <div class="col-md-12">
          <div class="banner_outer"> 
            <h1>catalogue</h1>
          </div>
        </div>
      </div>
    </div>
  </section>
  <br>
  <br>
  <br>


<!--Start Form Section-->

  {% if object_list %}
    <div class="container children_arm">
      <div class="row catalog_section_main">

        {% for product in object_listt %}
          <div class="col-md-4 col-sm-4">
            <div class="catalog_section">
              <img src="{{ product.image.url }}" alt="catalog">
              <div class="toy_section">
                <p class="main_product_name">
                  {{ product.name }}
                </p>
                <p>
                  ${{ product.price }}
                </p>
                <button href="javascript:void(0);" type="button" class="add_to_cart" data-id="{{ product.id }}">
                  Add to Cart
                </button>
                <div id='innerdiv1'></div>
                <h6 class="in-cart text-success" data-id="{{ product.id }}">

                  {% if product in cart %}
                    {% trans "IN CART" %} ({% get_product_count_in_cart product %})
                  {% else %}
                    &nbsp;
                  {% endif %}

                </h6>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>

    {% comment %} <div class="LatestNews_btn">
      <a type='button' class="showmore" id="showmore">Show More</a>
    </div> {% endcomment %}

  {% else %}

    <h1 class='text-warning'>
      Sorry, No Items Present in the Catalogue
    </h1>
    
  {% endif %}


<script src="{% static 'lib/jquery/jquery-3.1.1.min.js' %}"></script>
<script src="{% static 'lib/bootstrap/js/bootstrap.min.js' %}"></script>
<script src="{% static 'lib/fancybox/jquery.fancybox.pack.js' %}"></script>
<script src="{% static 'lib/jquery-validate/jquery.validate.min.js' %}"></script>
<script src="{% static 'lib/mmenu/jquery.mmenu.all.min.js' %}"></script>
<script src="{% static 'lib/slidesjs/jquery.slides.min.js' %}"></script>
<script src="{% static 'js/translate.js' %}"></script>
<script src="{% static 'js/site.js' %}"></script>
<script src="//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8&appId=190291501407"></script>
<script src="https://platform.twitter.com/widgets.js"></script>
<script src="//translate.google.com/translate_a/element.js?cb=TranslateInit"></script>
<script>
  function ajax_loading_modal(tf) {
    if (tf) {
        $('body').addClass("loading");
        $('#innerdiv1').addClass('ajax_loading_modal')
    } else {
        $('body').removeClass("loading");
        $('#innerdiv1').removeClass('ajax_loading_modal')
    }
  }
  $('.add_to_cart').click(function () {
        add_to_cart($(this).data('id'));
    });

    function add_to_cart(product_id) {
        ajax_loading_modal(true);
        $.get('/api/add_to_cart/', {product_id: product_id}, function (e) {
            if (e['error'] === 0) {
                // Change CART(x) val in the nav
                $('#cart-items-count').html(e['count'] > 0 ? '(' + e['count'] + ')' : '');
                // Add IN CART text to box
                $('.in-cart[data-id="' + product_id + '"]').html('IN CART (' + e['qty'] + ')');
            }
            else{
              window.location = "{% url 'login' %}";
            }
        }).always(function (e) {
            ajax_loading_modal(false);
        });
    }
    {% comment %} $('.showmore').click(function () {
      showmore();
    });
    function showmore(){
      ajax_loading_modal(true);
      $.get('/api/showmore/',function (e){
        if (e['error']==0){
          alert('help');
        }
      }).always(function (e) {
        ajax_loading_modal(false);
    });
    } {% endcomment %}
</script>


{% endblock %}